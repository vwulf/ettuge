import Data.Typeable

‡≤é‡≤°‡≤¨‡≤≤ ‡≤ï = scanl ‡≤ï
‡≤ï‡≤°‡≥Ü ‡≤ï = last ‡≤ï
‡≤â‡≤≤‡≥ç‡≤ü ‡≤ï = reverse ‡≤ï
‡≤§‡≤≤‡≥Ü ‡≤ï = head ‡≤ï
‡≤é‡≤°‡≤Æ‡≤°‡≥ç‡≤á‡≤∏‡≥ç‡≤â ‡≤ï = foldl ‡≤ï
‡≤Æ‡≥ç‡≤â‡≤¶‡≥ç‡≤∞‡≥ç‡≤á‡≤∏‡≥ç‡≤â ‡≤ï = print ‡≤ï

-- üî¶ üåû üîã  -> üåû üî¶ 
‡≤ü‡≥ç‡≤Ü‡≤∞‡≥ç‡≤ö‡≥ç :: (Num ‡≤Ö) => ‡≤Ö -> (‡≤Ö -> ‡≤Ö) -> ‡≤Ö
‡≤ü‡≥ç‡≤Ü‡≤∞‡≥ç‡≤ö‡≥ç ‡≤∏‡≥ç‡≤ä‡≤∞‡≥ç‡≤Ø ‡≤¨‡≤º‡≥ç‡≤Ü‡≤ü‡≥ç‡≤∞‡≥ç‡≤á = ‡≤¨‡≤º‡≥ç‡≤Ü‡≤ü‡≥ç‡≤∞‡≥ç‡≤á ‡≤∏‡≥ç‡≤ä‡≤∞‡≥ç‡≤Ø

-- ‚è≥ üï∞ -> üèÉ‚Äç‚ôÄÔ∏èüõë -> ‚åõÔ∏è 
‡≤ì‡≤°‡≥ç‡≤á‡≤∏‡≥ç‡≤â :: (Num ‡≤Ö) => [‡≤Ö -> ‡≤Ö] -> ‡≤Ö -> ‡≤Ö
‡≤ì‡≤°‡≥ç‡≤á‡≤∏‡≥ç‡≤â ‡≤ï‡≥ç‡≤∞‡≥ç‡≤á‡≤Ø‡≥ç‡≤é ‡≤ö‡≤∞ =
  let ‡≤â‡≤§‡≥ç‡≤§‡≤∞ = ‡≤ï‡≤°‡≥Ü $ ‡≤é‡≤°‡≤¨‡≤≤ (‡≤ü‡≥ç‡≤Ü‡≤∞‡≥ç‡≤ö‡≥ç) ‡≤ö‡≤∞ ‡≤ï‡≥ç‡≤∞‡≥ç‡≤á‡≤Ø‡≥ç‡≤é in
  ‡≤â‡≤§‡≥ç‡≤§‡≤∞

-- üìº üß† üíé? -> üíé ‚úÖ
‡≤π‡≤ø‡≤®‡≥ç‡≤¶‡≥ç‡≤é :: (Num ‡≤Ö) => [(‡≤Ö -> ‡≤Ö)] -> [‡≤Ö] -> [‡≤Ö] 
‡≤π‡≤ø‡≤®‡≥ç‡≤¶‡≥ç‡≤é ‡≤ï‡≤≥‡≥ç‡≤≥‡≤®‡≤¨‡≥ç‡≤â‡≤¶‡≥ç‡≤¶‡≥ç‡≤á ‡≤µ‡≤ú‡≥ç‡≤∞‡≤ó‡≤≥‡≥ç‡≤â =
  ‡≤â‡≤§‡≥ç‡≤§‡≤∞
  where
  ‡≤Ü‡≤ï‡≤≥‡≥ç‡≤≥‡≤®‡≤µ‡≤ú‡≥ç‡≤∞‡≤ó‡≤≥‡≥ç‡≤â = ‡≤§‡≤≤‡≥Ü ‡≤µ‡≤ú‡≥ç‡≤∞‡≤ó‡≤≥‡≥ç‡≤â
  ‡≤à‡≤ï‡≤≥‡≥ç‡≤≥‡≤®‡≤µ‡≤ú‡≥ç‡≤∞‡≤ó‡≤≥‡≥ç‡≤â = ‡≤ï‡≤≥‡≥ç‡≤≥‡≤®‡≤¨‡≥ç‡≤â‡≤¶‡≥ç‡≤¶‡≥ç‡≤á `‡≤ì‡≤°‡≥ç‡≤á‡≤∏‡≥ç‡≤â` ‡≤Ü‡≤ï‡≤≥‡≥ç‡≤≥‡≤®‡≤µ‡≤ú‡≥ç‡≤∞‡≤ó‡≤≥‡≥ç‡≤â
  ‡≤â‡≤§‡≥ç‡≤§‡≤∞ = ‡≤à‡≤ï‡≤≥‡≥ç‡≤≥‡≤®‡≤µ‡≤ú‡≥ç‡≤∞‡≤ó‡≤≥‡≥ç‡≤â : ‡≤µ‡≤ú‡≥ç‡≤∞‡≤ó‡≤≥‡≥ç‡≤â

-- ‚å®Ô∏è üì∫ üë©‚Äçüç≥ -> üç≤ 
‡≤Æ‡≥ç‡≤â‡≤ñ‡≥ç‡≤Ø :: IO ()
‡≤Æ‡≥ç‡≤â‡≤ñ‡≥ç‡≤Ø = do
  let ‡≤ï‡≤≥‡≥ç‡≤≥‡≤∞‡≤∏‡≥ç‡≤Ö‡≤Æ‡≥ç‡≤ñ‡≥ç‡≤Ø‡≥ç‡≤é = 5
  let ‡≤ï‡≥ç‡≤í‡≤®‡≥ç‡≤é‡≤ï‡≤≥‡≥ç‡≤≥‡≤®‡≤µ‡≤ú‡≥ç‡≤∞‡≤ó‡≤≥‡≥ç‡≤â = 1
  let ‡≤ï‡≤≥‡≥ç‡≤≥‡≤®‡≤¨‡≥ç‡≤â‡≤¶‡≥ç‡≤¶‡≥ç‡≤á = ‡≤â‡≤≤‡≥ç‡≤ü [(*2),(+2)]
  let ‡≤í‡≤®‡≥ç‡≤¶‡≥ç‡≤â‡≤∏‡≤≤ = (‡≤π‡≤ø‡≤®‡≥ç‡≤¶‡≥ç‡≤é ‡≤ï‡≤≥‡≥ç‡≤≥‡≤®‡≤¨‡≥ç‡≤â‡≤¶‡≥ç‡≤¶‡≥ç‡≤á)
  let ‡≤ï‡≤≥‡≥ç‡≤≥‡≤®‡≤µ‡≤ú‡≥ç‡≤∞‡≤ó‡≤≥‡≥ç‡≤â ‡≤ö‡≤∞ _ = ‡≤í‡≤®‡≥ç‡≤¶‡≥ç‡≤â‡≤∏‡≤≤ ‡≤ö‡≤∞
  let ‡≤ñ‡≤ú‡≤º‡≥ç‡≤Ü‡≤®‡≥ç‡≤é = ‡≤é‡≤°‡≤Æ‡≤°‡≥ç‡≤á‡≤∏‡≥ç‡≤â ‡≤ï‡≤≥‡≥ç‡≤≥‡≤®‡≤µ‡≤ú‡≥ç‡≤∞‡≤ó‡≤≥‡≥ç‡≤â [‡≤ï‡≥ç‡≤í‡≤®‡≥ç‡≤é‡≤ï‡≤≥‡≥ç‡≤≥‡≤®‡≤µ‡≤ú‡≥ç‡≤∞‡≤ó‡≤≥‡≥ç‡≤â] [1..(‡≤ï‡≤≥‡≥ç‡≤≥‡≤∞‡≤∏‡≥ç‡≤Ö‡≤Æ‡≥ç‡≤ñ‡≥ç‡≤Ø‡≥ç‡≤é -1)]
  ‡≤Æ‡≥ç‡≤â‡≤¶‡≥ç‡≤∞‡≥ç‡≤á‡≤∏‡≥ç‡≤â $ ‡≤§‡≤≤‡≥Ü ‡≤ñ‡≤ú‡≤º‡≥ç‡≤Ü‡≤®‡≥ç‡≤é
  ‡≤Æ‡≥ç‡≤â‡≤¶‡≥ç‡≤∞‡≥ç‡≤á‡≤∏‡≥ç‡≤â $ ‡≤ñ‡≤ú‡≤º‡≥ç‡≤Ü‡≤®‡≥ç‡≤é
  
main = ‡≤Æ‡≥ç‡≤â‡≤ñ‡≥ç‡≤Ø
